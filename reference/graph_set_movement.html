<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Define the movement model of a graph — graph_set_movement • GeoPressureR</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Define the movement model of a graph — graph_set_movement"><meta name="description" content='Configure the movement model of a graph by defining the value of the parameters needed to build
the transition graph_transition() through speed2prob().
Three methods are currently implemented with two parametric function "gamma" and "logis"
suitable when wind data is not available and are thus defining the probability of a groundspeed.
If wind data is available, it is recommended to use the "power" method which rely on the power
curve equation (energy vs airspeed) to estimate the probability of a airspeed. Read more about
this approach in section 2.2.5. of Nussbaumer et al. (2023b)'><meta property="og:description" content='Configure the movement model of a graph by defining the value of the parameters needed to build
the transition graph_transition() through speed2prob().
Three methods are currently implemented with two parametric function "gamma" and "logis"
suitable when wind data is not available and are thus defining the probability of a groundspeed.
If wind data is available, it is recommended to use the "power" method which rely on the power
curve equation (energy vs airspeed) to estimate the probability of a airspeed. Read more about
this approach in section 2.2.5. of Nussbaumer et al. (2023b)'><meta property="og:image" content="https://raphaelnussbaumer.com/GeoPressureR/logo.png"><!-- Global site tag (gtag.js) - Google Analytics --><script async src="https://www.googletagmanager.com/gtag/js?id=G-M5FY4BPHTB"></script><script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-M5FY4BPHTB');
</script><!-- Google tag (gtag.js) --></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">GeoPressureR</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="Released version">3.3.4</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">News</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/Rafnuss/GeoPressureR/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Define the movement model of a <code>graph</code></h1>
      <small class="dont-index">Source: <a href="https://github.com/Rafnuss/GeoPressureR/blob/master/R/graph_set_movement.R" class="external-link"><code>R/graph_set_movement.R</code></a></small>
      <div class="d-none name"><code>graph_set_movement.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Configure the movement model of a <code>graph</code> by defining the value of the parameters needed to build
the transition <code><a href="graph_transition.html">graph_transition()</a></code> through <code><a href="speed2prob.html">speed2prob()</a></code>.</p>
<p>Three methods are currently implemented with two parametric function <code>"gamma"</code> and <code>"logis"</code>
suitable when wind data is not available and are thus defining the probability of a groundspeed.</p>
<p>If wind data is available, it is recommended to use the <code>"power"</code> method which rely on the power
curve equation (energy vs airspeed) to estimate the probability of a airspeed. Read more about
this approach in <a href="https://besjournals.onlinelibrary.wiley.com/doi/10.1111/2041-210X.14082#mee314082-sec-0009-title" class="external-link">section 2.2.5. of Nussbaumer et al. (2023b)</a></p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">graph_set_movement</span><span class="op">(</span></span>
<span>  <span class="va">graph</span>,</span>
<span>  type <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="st">"ws"</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">graph</span><span class="op">)</span>, <span class="st">"as"</span>, <span class="st">"gs"</span><span class="op">)</span>,</span>
<span>  method <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="st">"ws"</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">graph</span><span class="op">)</span>, <span class="st">"power"</span>, <span class="st">"gamma"</span><span class="op">)</span>,</span>
<span>  shape <span class="op">=</span> <span class="fl">7</span>,</span>
<span>  scale <span class="op">=</span> <span class="fl">7</span>,</span>
<span>  location <span class="op">=</span> <span class="fl">40</span>,</span>
<span>  bird <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  power2prob <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">power</span><span class="op">)</span> <span class="op">(</span><span class="fl">1</span><span class="op">/</span><span class="va">power</span><span class="op">)</span><span class="op">^</span><span class="fl">3</span>,</span>
<span>  low_speed_fix <span class="op">=</span> <span class="fl">15</span>,</span>
<span>  zero_speed_ratio <span class="op">=</span> <span class="fl">1</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-graph">graph<a class="anchor" aria-label="anchor" href="#arg-graph"></a></dt>
<dd><p>a GeoPressureR <code>graph</code> object.</p></dd>


<dt id="arg-type">type<a class="anchor" aria-label="anchor" href="#arg-type"></a></dt>
<dd><p>Ground speed <code>"gs"</code> or airspeed <code>"as"</code></p></dd>


<dt id="arg-method">method<a class="anchor" aria-label="anchor" href="#arg-method"></a></dt>
<dd><p>method used to convert the speed to probability ("gamma", "logis" or "power")</p></dd>


<dt id="arg-shape">shape<a class="anchor" aria-label="anchor" href="#arg-shape"></a></dt>
<dd><p>parameter of the gamma distribution (km/h)</p></dd>


<dt id="arg-scale">scale<a class="anchor" aria-label="anchor" href="#arg-scale"></a></dt>
<dd><p>parameter of the gamma and logistic distribution (km/h)</p></dd>


<dt id="arg-location">location<a class="anchor" aria-label="anchor" href="#arg-location"></a></dt>
<dd><p>parameter for the logistic distribution (km/h)</p></dd>


<dt id="arg-bird">bird<a class="anchor" aria-label="anchor" href="#arg-bird"></a></dt>
<dd><p>A GeoPressureR <code>bird</code> object containing the basic morphological traits necessary:
mass, wing span, wing aspect ratio, and body frontal area. See <code><a href="bird_create.html">bird_create()</a></code>.</p></dd>


<dt id="arg-power-prob">power2prob<a class="anchor" aria-label="anchor" href="#arg-power-prob"></a></dt>
<dd><p>function taking power as a single argument and returning a probability</p></dd>


<dt id="arg-low-speed-fix">low_speed_fix<a class="anchor" aria-label="anchor" href="#arg-low-speed-fix"></a></dt>
<dd><p>speed below which the probability remains the same, i.e. we assign the same
probability at <code>low_speed_fix</code> for any lower speed. This parameter is used to allow short
flights covering small distances. (unit of km/h)</p></dd>


<dt id="arg-zero-speed-ratio">zero_speed_ratio<a class="anchor" aria-label="anchor" href="#arg-zero-speed-ratio"></a></dt>
<dd><p>multiplicative ratio of the probability for speed zero. This ratio apply
only when the bird is stayin at the same location (fly and come back or stay within pixel size).
This parameter (when greater than 1) is used to favour a bird to stay at the same location rather
than perform short fly.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>Graph list with a new list <code>graph$movement</code> storing all the parameters needed to compute
the transition probability</p>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Nussbaumer, Raphaël, Mathieu Gravey, Martins Briedis, Felix Liechti, and Daniel
Sheldon. 2023. Reconstructing bird trajectories from pressure and wind data using a highly
optimized hidden Markov model. <em>Methods in Ecology and Evolution</em>, 14, 1118–1129
<a href="https://doi.org/10.1111/2041-210X.14082" class="external-link">https://doi.org/10.1111/2041-210X.14082</a>.</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p>Other graph:
<code><a href="graph_create.html">graph_create</a>()</code>,
<code><a href="graph_marginal.html">graph_marginal</a>()</code>,
<code><a href="graph_most_likely.html">graph_most_likely</a>()</code>,
<code><a href="graph_simulation.html">graph_simulation</a>()</code>,
<code><a href="print.graph.html">print.graph</a>()</code></p>
<p>Other movement:
<code><a href="bird_create.html">bird_create</a>()</code>,
<code><a href="graph_transition.html">graph_transition</a>()</code>,
<code><a href="plot_graph_movement.html">plot_graph_movement</a>()</code>,
<code><a href="speed2prob.html">speed2prob</a>()</code>,
<code><a href="tag_download_wind.html">tag_download_wind</a>()</code></p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="fu">withr</span><span class="fu">::</span><span class="fu"><a href="https://withr.r-lib.org/reference/with_dir.html" class="external-link">with_dir</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, package <span class="op">=</span> <span class="st">"GeoPressureR"</span><span class="op">)</span>, <span class="op">{</span></span></span>
<span class="r-in"><span>  <span class="va">tag</span> <span class="op">&lt;-</span> <span class="fu"><a href="tag_create.html">tag_create</a></span><span class="op">(</span><span class="st">"18LX"</span>, quiet <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op">|&gt;</span></span></span>
<span class="r-in"><span>    <span class="fu"><a href="tag_label.html">tag_label</a></span><span class="op">(</span>quiet <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op">|&gt;</span></span></span>
<span class="r-in"><span>    <span class="fu"><a href="twilight_create.html">twilight_create</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span></span>
<span class="r-in"><span>    <span class="fu"><a href="twilight_label_read.html">twilight_label_read</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span></span>
<span class="r-in"><span>    <span class="fu"><a href="tag_set_map.html">tag_set_map</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>      extent <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">16</span>, <span class="fl">23</span>, <span class="fl">0</span>, <span class="fl">50</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>      known <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>stap_id <span class="op">=</span> <span class="fl">1</span>, known_lon <span class="op">=</span> <span class="fl">17.05</span>, known_lat <span class="op">=</span> <span class="fl">48.9</span><span class="op">)</span></span></span>
<span class="r-in"><span>    <span class="op">)</span> <span class="op">|&gt;</span></span></span>
<span class="r-in"><span>    <span class="fu"><a href="geopressure_map.html">geopressure_map</a></span><span class="op">(</span>quiet <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op">|&gt;</span></span></span>
<span class="r-in"><span>    <span class="fu"><a href="geolight_map.html">geolight_map</a></span><span class="op">(</span>quiet <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">graph</span> <span class="op">&lt;-</span> <span class="fu"><a href="graph_create.html">graph_create</a></span><span class="op">(</span><span class="va">tag</span>, quiet <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">graph</span> <span class="op">&lt;-</span> <span class="fu">graph_set_movement</span><span class="op">(</span><span class="va">graph</span>,</span></span>
<span class="r-in"><span>  method <span class="op">=</span> <span class="st">"gamma"</span>,</span></span>
<span class="r-in"><span>  shape <span class="op">=</span> <span class="fl">4</span>,</span></span>
<span class="r-in"><span>  scale <span class="op">=</span> <span class="fl">6</span>,</span></span>
<span class="r-in"><span>  low_speed_fix <span class="op">=</span> <span class="fl">10</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="plot_graph_movement.html">plot_graph_movement</a></span><span class="op">(</span><span class="va">graph</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="graph_set_movement-1.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">graph</span> <span class="op">&lt;-</span> <span class="fu">graph_set_movement</span><span class="op">(</span><span class="va">graph</span>,</span></span>
<span class="r-in"><span>  method <span class="op">=</span> <span class="st">"logis"</span>,</span></span>
<span class="r-in"><span>  shape <span class="op">=</span> <span class="fl">4</span>,</span></span>
<span class="r-in"><span>  location <span class="op">=</span> <span class="fl">60</span>,</span></span>
<span class="r-in"><span>  low_speed_fix <span class="op">=</span> <span class="fl">10</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="plot_graph_movement.html">plot_graph_movement</a></span><span class="op">(</span><span class="va">graph</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="graph_set_movement-2.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Raphaël Nussbaumer, Mathieu Gravey.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer></div>





  </body></html>

