<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en-GB"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Request and download pressure time series at a given location — geopressure_timeseries • GeoPressureR</title><!-- favicons --><link rel="icon" type="image/png" sizes="96x96" href="../favicon-96x96.png"><link rel="icon" type="”image/svg+xml”" href="../favicon.svg"><link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png"><link rel="icon" sizes="any" href="../favicon.ico"><link rel="manifest" href="../site.webmanifest"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Request and download pressure time series at a given location — geopressure_timeseries"><meta name="description" content="This function returns the surface atmospheric pressure time series from ERA5 at any requested
location.
If the location queried is over water, the location will be moved to the closest onshore
location.
The ERA5 pressure time series of the response \(P_{ERA}\) will be provided on a hourly basis
between start_time and end_time or the same as pressure$date if pressure is supplied.
If you supply the pressure of the geolocator \(P_{gl}\), the function will
additionally return the altitude of the geolocator above sea level \(z_{gl}\) using the
barometric equation,
$$ z_{{gl}}(x)=z_{ERA5}(x) + \frac{T_{ERA5}(x)}{L_b}  \left( \frac{P_{gl}}{P_{ERA5}(x)}
\right)^{\frac{RL_b}{g M}-1},$$
where \(z_{ERA}\), \(T_{ERA}\), and \(P_{ERA}\) respectively correspond to the ground level
elevation, temperature at 2m, and ground level pressure of ERA5, \(L_b\)  is the standard
temperature lapse rate, \(R\) is the universal gas constant, \(g\) is the gravity constant
and  \(M\) is the molar mass of air. See more information at
the GeoPressureAPI documentation.
To be able to compare the temporal variation of the retrieved pressure of ERA5 \(P_{ERA}\) to
the geolocator pressure \(P_{gl}\), the function also returns the ERA pressure normalized with
the geolocator mean pressure measurement as surface_pressure_norm.
$$ P_{ERA5,0}(\boldsymbol{x})[t] = \left( P_{ERA5}(\boldsymbol{x})[t]-P_{gl}[t]\right) -
\left( \frac{1}{n}\sum_{i=1}^{n} P_{ERA5}(\boldsymbol{x})[i]-P_{gl}[i] \right).$$"><meta property="og:description" content="This function returns the surface atmospheric pressure time series from ERA5 at any requested
location.
If the location queried is over water, the location will be moved to the closest onshore
location.
The ERA5 pressure time series of the response \(P_{ERA}\) will be provided on a hourly basis
between start_time and end_time or the same as pressure$date if pressure is supplied.
If you supply the pressure of the geolocator \(P_{gl}\), the function will
additionally return the altitude of the geolocator above sea level \(z_{gl}\) using the
barometric equation,
$$ z_{{gl}}(x)=z_{ERA5}(x) + \frac{T_{ERA5}(x)}{L_b}  \left( \frac{P_{gl}}{P_{ERA5}(x)}
\right)^{\frac{RL_b}{g M}-1},$$
where \(z_{ERA}\), \(T_{ERA}\), and \(P_{ERA}\) respectively correspond to the ground level
elevation, temperature at 2m, and ground level pressure of ERA5, \(L_b\)  is the standard
temperature lapse rate, \(R\) is the universal gas constant, \(g\) is the gravity constant
and  \(M\) is the molar mass of air. See more information at
the GeoPressureAPI documentation.
To be able to compare the temporal variation of the retrieved pressure of ERA5 \(P_{ERA}\) to
the geolocator pressure \(P_{gl}\), the function also returns the ERA pressure normalized with
the geolocator mean pressure measurement as surface_pressure_norm.
$$ P_{ERA5,0}(\boldsymbol{x})[t] = \left( P_{ERA5}(\boldsymbol{x})[t]-P_{gl}[t]\right) -
\left( \frac{1}{n}\sum_{i=1}^{n} P_{ERA5}(\boldsymbol{x})[i]-P_{gl}[i] \right).$$"><meta property="og:image" content="https://raphaelnussbaumer.com/GeoPressureR/logo.png"><!-- Global site tag (gtag.js) - Google Analytics --><script async src="https://www.googletagmanager.com/gtag/js?id=G-M5FY4BPHTB"></script><script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-M5FY4BPHTB');
</script><!-- Google tag (gtag.js) --></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">GeoPressureR</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="Released version">3.4.1</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">News</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/Rafnuss/GeoPressureR/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Request and download pressure time series at a given location</h1>
      <small class="dont-index">Source: <a href="https://github.com/Rafnuss/GeoPressureR/blob/master/R/geopressure_timeseries.R" class="external-link"><code>R/geopressure_timeseries.R</code></a></small>
      <div class="d-none name"><code>geopressure_timeseries.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>This function returns the surface atmospheric pressure time series from ERA5 at any requested
location.</p>
<p>If the location queried is over water, the location will be moved to the closest onshore
location.</p>
<p>The ERA5 pressure time series of the response \(P_{ERA}\) will be provided on a hourly basis
between <code>start_time</code> and <code>end_time</code> or the same as <code>pressure$date</code> if <code>pressure</code> is supplied.</p>
<p>If you supply the <code>pressure</code> of the geolocator \(P_{gl}\), the function will
additionally return the altitude of the geolocator above sea level \(z_{gl}\) using the
barometric equation,
$$ z_{{gl}}(x)=z_{ERA5}(x) + \frac{T_{ERA5}(x)}{L_b}  \left( \frac{P_{gl}}{P_{ERA5}(x)}
\right)^{\frac{RL_b}{g M}-1},$$
where \(z_{ERA}\), \(T_{ERA}\), and \(P_{ERA}\) respectively correspond to the ground level
elevation, temperature at 2m, and ground level pressure of ERA5, \(L_b\)  is the standard
temperature lapse rate, \(R\) is the universal gas constant, \(g\) is the gravity constant
and  \(M\) is the molar mass of air. See more information at
<a href="https://raphaelnussbaumer.com/GeoPressureAPI/#description-1" class="external-link">the GeoPressureAPI documentation</a>.</p>
<p>To be able to compare the temporal variation of the retrieved pressure of ERA5 \(P_{ERA}\) to
the geolocator pressure \(P_{gl}\), the function also returns the ERA pressure normalized with
the geolocator mean pressure measurement as <code>surface_pressure_norm</code>.
$$ P_{ERA5,0}(\boldsymbol{x})[t] = \left( P_{ERA5}(\boldsymbol{x})[t]-P_{gl}[t]\right) -
\left( \frac{1}{n}\sum_{i=1}^{n} P_{ERA5}(\boldsymbol{x})[i]-P_{gl}[i] \right).$$</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">geopressure_timeseries</span><span class="op">(</span></span>
<span>  <span class="va">lat</span>,</span>
<span>  <span class="va">lon</span>,</span>
<span>  pressure <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  start_time <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  end_time <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  timeout <span class="op">=</span> <span class="fl">60</span> <span class="op">*</span> <span class="fl">5</span>,</span>
<span>  quiet <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  debug <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-lat">lat<a class="anchor" aria-label="anchor" href="#arg-lat"></a></dt>
<dd><p>Latitude to query (0° to 90°).</p></dd>


<dt id="arg-lon">lon<a class="anchor" aria-label="anchor" href="#arg-lon"></a></dt>
<dd><p>Longitude to query (-180° to 180°).</p></dd>


<dt id="arg-pressure">pressure<a class="anchor" aria-label="anchor" href="#arg-pressure"></a></dt>
<dd><p>A data.frame of pressure time series, containing at least a <code>"date"</code> and
<code>"value"</code> column.</p></dd>


<dt id="arg-start-time">start_time<a class="anchor" aria-label="anchor" href="#arg-start-time"></a></dt>
<dd><p>If <code>pressure</code> is not provided, <code>start_time</code> defines the start time of
the time series as POSIXlt.</p></dd>


<dt id="arg-end-time">end_time<a class="anchor" aria-label="anchor" href="#arg-end-time"></a></dt>
<dd><p>If <code>pressure</code> is not provided, <code>end_time</code> defines the end time of
the time series as POSIXlt.</p></dd>


<dt id="arg-timeout">timeout<a class="anchor" aria-label="anchor" href="#arg-timeout"></a></dt>
<dd><p>duration before the code is interrupted both for the request on
GeoPressureAPI and on GEE (in seconds, see <code><a href="https://httr2.r-lib.org/reference/req_timeout.html" class="external-link">httr2::req_timeout()</a></code>).</p></dd>


<dt id="arg-quiet">quiet<a class="anchor" aria-label="anchor" href="#arg-quiet"></a></dt>
<dd><p>logical to hide messages about the progress</p></dd>


<dt id="arg-debug">debug<a class="anchor" aria-label="anchor" href="#arg-debug"></a></dt>
<dd><p>logical to display additional information to debug a request</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A data.frame containing</p><ul><li><p><code>date</code> POSIXct date time</p></li>
<li><p><code>surface_pressure</code> pressure (hPa)</p></li>
<li><p><code>lon</code> same as input <code>lon</code> except if over water</p></li>
<li><p><code>lat</code> same as input <code>lat</code> except if over water.</p></li>
<li><p><code>surface_pressure_norm</code> only if <code>pressure</code> is provided as input</p></li>
<li><p><code>altitude</code> only if <code>pressure</code> is provided as input</p></li>
</ul></div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Nussbaumer, Raphaël, Mathieu Gravey, Martins Briedis, and Felix Liechti. 2023.
Global Positioning with Animal‐borne Pressure Sensors. <em>Methods in Ecology and Evolution</em>, 14,
1118–1129 <a href="https://doi.org/10.1111/2041-210X.14043" class="external-link">https://doi.org/10.1111/2041-210X.14043</a>.</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p>Other pressurepath:
<code><a href="plot_pressurepath.html">plot_pressurepath</a>()</code>,
<code><a href="pressurepath_create.html">pressurepath_create</a>()</code></p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># Request pressure at a given location</span></span></span>
<span class="r-in"><span><span class="va">pressurepath</span> <span class="op">&lt;-</span> <span class="fu">geopressure_timeseries</span><span class="op">(</span></span></span>
<span class="r-in"><span>  lat <span class="op">=</span> <span class="fl">46</span>, lon <span class="op">=</span> <span class="fl">6</span>,</span></span>
<span class="r-in"><span>  start_time <span class="op">=</span> <span class="st">"2017-01-01 00:00"</span>,</span></span>
<span class="r-in"><span>  end_time <span class="op">=</span> <span class="st">"2017-01-02 00:00"</span>,</span></span>
<span class="r-in"><span>  quiet <span class="op">=</span> <span class="cn">TRUE</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/str.html" class="external-link">str</a></span><span class="op">(</span><span class="va">pressurepath</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 'data.frame':	25 obs. of  4 variables:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  $ date            : POSIXct, format: "2017-01-01 00:00:00" "2017-01-01 01:00:00" ...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  $ surface_pressure: num  969 969 968 968 967 ...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  $ lat             : num  46 46 46 46 46 46 46 46 46 46 ...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  $ lon             : num  6 6 6 6 6 6 6 6 6 6 ...</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">pressurepath</span><span class="op">$</span><span class="va">date</span>, <span class="va">pressurepath</span><span class="op">$</span><span class="va">surface_pressure</span>,</span></span>
<span class="r-in"><span>  type <span class="op">=</span> <span class="st">"b"</span>, ylab <span class="op">=</span> <span class="st">"Pressure (hPa)"</span>, xlab <span class="op">=</span> <span class="st">"Datetime"</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="geopressure_timeseries-1.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Retrieve the altitude of a bird being at this location adding random noise on the sensor.</span></span></span>
<span class="r-in"><span><span class="va">pressurepath</span> <span class="op">&lt;-</span> <span class="fu">geopressure_timeseries</span><span class="op">(</span></span></span>
<span class="r-in"><span>  lat <span class="op">=</span> <span class="fl">46</span>, lon <span class="op">=</span> <span class="fl">6</span>,</span></span>
<span class="r-in"><span>  pressure <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>    <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>      date <span class="op">=</span> <span class="va">pressurepath</span><span class="op">$</span><span class="va">date</span>,</span></span>
<span class="r-in"><span>      value <span class="op">=</span> <span class="va">pressurepath</span><span class="op">$</span><span class="va">surface_pressure</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">pressurepath</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span>    <span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="op">)</span>,</span></span>
<span class="r-in"><span>  quiet <span class="op">=</span> <span class="cn">TRUE</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/str.html" class="external-link">str</a></span><span class="op">(</span><span class="va">pressurepath</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 'data.frame':	25 obs. of  7 variables:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  $ date                 : POSIXct, format: "2017-01-01 00:00:00" "2017-01-01 01:00:00" ...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  $ pressure_tag         : num  969 968 969 967 967 ...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  $ surface_pressure     : num  969 969 968 968 967 ...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  $ altitude             : num  485 489 478 492 488 ...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  $ lat                  : num  46 46 46 46 46 46 46 46 46 46 ...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  $ lon                  : num  6 6 6 6 6 6 6 6 6 6 ...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  $ surface_pressure_norm: num  970 969 968 968 967 ...</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">pressurepath</span><span class="op">$</span><span class="va">date</span>, <span class="va">pressurepath</span><span class="op">$</span><span class="va">altitude</span>,</span></span>
<span class="r-in"><span>  type <span class="op">=</span> <span class="st">"b"</span>, ylab <span class="op">=</span> <span class="st">"Altitude (m)"</span>, xlab <span class="op">=</span> <span class="st">"Datetime"</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="geopressure_timeseries-2.png" alt="" width="700" height="433"></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Raphaël Nussbaumer, Mathieu Gravey.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.2.</p>
</div>

    </footer></div>





  </body></html>

