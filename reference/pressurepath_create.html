<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en-GB"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Create a pressurepath — pressurepath_create • GeoPressureR</title><!-- favicons --><link rel="icon" type="image/png" sizes="96x96" href="../favicon-96x96.png"><link rel="icon" type="”image/svg+xml”" href="../favicon.svg"><link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png"><link rel="icon" sizes="any" href="../favicon.ico"><link rel="manifest" href="../site.webmanifest"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Create a pressurepath — pressurepath_create"><meta name="description" content="A pressurepath is a data.frame merging path and tag$pressure. It can be thought as the
equivalent of the measurement of variables by sensors equipped on the bird moving along a
specific path.
Any ERA variables can be retrieve but the functions is most notably used to retrieve ERA5
surface pressure to then be able to compare it to the pressure measured by the tag, and
potentially adjust labelling tag data.
By default, We use both the ERA5 LAND and
ERA5 surface level if position over water. Available
variables can be listed with GeoPressureR:::pressurepath_variable and details description
can be found on the parameter listings in ERA5 doc.
Note that their exact name might be be different as we query them through Google Earth Engine.
Positions during the flight are estimated by linear interpolation of the position of the stap
before and after. pressurepath_create() does not return measurement for stationary periods
which are not provided in path as well as the flight before and after.
also return the altitude of the bird along its trajectory. The altitude
\(z_{tag}\) (a.s.l.) is computed from the tag pressure \(P_{tag}\), using the barometric
equation $$ z_{{tag}}(x)=z_{ERA5}(x) + \frac{T_{ERA5}(x)}{L_b}  \left(
\frac{P_{tag}}{P_{ERA5}(x)} \right)^{\frac{RL_b}{g M}-1},$$
where \(z_{ERA}\), \(T_{ERA}\), and \(P_{ERA}\) respectively correspond to the ground level
elevation, temperature at 2m, and ground level pressure of ERA5, \(L_b\)  is the standard
temperature lapse rate, \(R\) is the universal gas constant, \(g\) is the gravity constant
and  \(M\) is the molar mass of air. See more information at
the GeoPressureAPI documentation.
To be able to compare the temporal variation of the retrieved pressure of ERA5 \(P_{ERA}\) to
the tag pressure \(P_{tag}\), the function also returns the ERA pressure normalized with
the tag mean pressure measurement as surface_pressure_norm.
$$ P_{ERA5,0}(\boldsymbol{x})[t] = \left( P_{ERA5}(\boldsymbol{x})[t]-P_{tag}[t]\right) -
\left( \frac{1}{n}\sum_{i=1}^{n} P_{ERA5}(\boldsymbol{x})[i]-P_{tag}[i] \right).$$
pressurepath_create() also computes the local sunrise and sunset times for each timestep
according to the position of the path using path2twilight(). Sunrise and sunset are defined
by the solar depression angle solar_dep."><meta property="og:description" content="A pressurepath is a data.frame merging path and tag$pressure. It can be thought as the
equivalent of the measurement of variables by sensors equipped on the bird moving along a
specific path.
Any ERA variables can be retrieve but the functions is most notably used to retrieve ERA5
surface pressure to then be able to compare it to the pressure measured by the tag, and
potentially adjust labelling tag data.
By default, We use both the ERA5 LAND and
ERA5 surface level if position over water. Available
variables can be listed with GeoPressureR:::pressurepath_variable and details description
can be found on the parameter listings in ERA5 doc.
Note that their exact name might be be different as we query them through Google Earth Engine.
Positions during the flight are estimated by linear interpolation of the position of the stap
before and after. pressurepath_create() does not return measurement for stationary periods
which are not provided in path as well as the flight before and after.
also return the altitude of the bird along its trajectory. The altitude
\(z_{tag}\) (a.s.l.) is computed from the tag pressure \(P_{tag}\), using the barometric
equation $$ z_{{tag}}(x)=z_{ERA5}(x) + \frac{T_{ERA5}(x)}{L_b}  \left(
\frac{P_{tag}}{P_{ERA5}(x)} \right)^{\frac{RL_b}{g M}-1},$$
where \(z_{ERA}\), \(T_{ERA}\), and \(P_{ERA}\) respectively correspond to the ground level
elevation, temperature at 2m, and ground level pressure of ERA5, \(L_b\)  is the standard
temperature lapse rate, \(R\) is the universal gas constant, \(g\) is the gravity constant
and  \(M\) is the molar mass of air. See more information at
the GeoPressureAPI documentation.
To be able to compare the temporal variation of the retrieved pressure of ERA5 \(P_{ERA}\) to
the tag pressure \(P_{tag}\), the function also returns the ERA pressure normalized with
the tag mean pressure measurement as surface_pressure_norm.
$$ P_{ERA5,0}(\boldsymbol{x})[t] = \left( P_{ERA5}(\boldsymbol{x})[t]-P_{tag}[t]\right) -
\left( \frac{1}{n}\sum_{i=1}^{n} P_{ERA5}(\boldsymbol{x})[i]-P_{tag}[i] \right).$$
pressurepath_create() also computes the local sunrise and sunset times for each timestep
according to the position of the path using path2twilight(). Sunrise and sunset are defined
by the solar depression angle solar_dep."><meta property="og:image" content="https://raphaelnussbaumer.com/GeoPressureR/logo.png"><!-- Global site tag (gtag.js) - Google Analytics --><script async src="https://www.googletagmanager.com/gtag/js?id=G-M5FY4BPHTB"></script><script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-M5FY4BPHTB');
</script><!-- Google tag (gtag.js) --></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">GeoPressureR</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="Released version">3.4.2</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">News</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/Rafnuss/GeoPressureR/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Create a <code>pressurepath</code></h1>
      <small class="dont-index">Source: <a href="https://github.com/Rafnuss/GeoPressureR/blob/v3.4.2/R/pressurepath_create.R" class="external-link"><code>R/pressurepath_create.R</code></a></small>
      <div class="d-none name"><code>pressurepath_create.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>A <code>pressurepath</code> is a data.frame merging <code>path</code> and <code>tag$pressure</code>. It can be thought as the
equivalent of the measurement of variables by sensors equipped on the bird moving along a
specific <code>path</code>.</p>
<p>Any ERA variables can be retrieve but the functions is most notably used to retrieve ERA5
surface pressure to then be able to compare it to the pressure measured by the tag, and
potentially adjust labelling tag data.</p>
<p>By default, We use both the <a href="https://doi.org/10.24381/cds.e2161bac" class="external-link">ERA5 LAND</a> and
<a href="https://doi.org/10.24381/cds.adbb2d47" class="external-link">ERA5 surface level</a> if position over water. Available
variables can be listed with <code>GeoPressureR:::pressurepath_variable</code> and details description
can be found on the <a href="https://confluence.ecmwf.int/display/CKB/ERA5%3A+data+documentation#heading-Parameterlistings" class="external-link">parameter listings in ERA5 doc</a>.
Note that their exact name might be be different as we query them through Google Earth Engine.</p>
<p>Positions during the flight are estimated by linear interpolation of the position of the stap
before and after. <code>pressurepath_create()</code> does not return measurement for stationary periods
which are not provided in <code>path</code> as well as the flight before and after.</p>
<p>also return the altitude of the bird along its trajectory. The altitude
\(z_{tag}\) (a.s.l.) is computed from the tag pressure \(P_{tag}\), using the barometric
equation $$ z_{{tag}}(x)=z_{ERA5}(x) + \frac{T_{ERA5}(x)}{L_b}  \left(
\frac{P_{tag}}{P_{ERA5}(x)} \right)^{\frac{RL_b}{g M}-1},$$
where \(z_{ERA}\), \(T_{ERA}\), and \(P_{ERA}\) respectively correspond to the ground level
elevation, temperature at 2m, and ground level pressure of ERA5, \(L_b\)  is the standard
temperature lapse rate, \(R\) is the universal gas constant, \(g\) is the gravity constant
and  \(M\) is the molar mass of air. See more information at
<a href="https://raphaelnussbaumer.com/GeoPressureAPI/#description-1" class="external-link">the GeoPressureAPI documentation</a>.</p>
<p>To be able to compare the temporal variation of the retrieved pressure of ERA5 \(P_{ERA}\) to
the tag pressure \(P_{tag}\), the function also returns the ERA pressure normalized with
the tag mean pressure measurement as <code>surface_pressure_norm</code>.
$$ P_{ERA5,0}(\boldsymbol{x})[t] = \left( P_{ERA5}(\boldsymbol{x})[t]-P_{tag}[t]\right) -
\left( \frac{1}{n}\sum_{i=1}^{n} P_{ERA5}(\boldsymbol{x})[i]-P_{tag}[i] \right).$$</p>
<p><code>pressurepath_create()</code> also computes the local sunrise and sunset times for each timestep
according to the position of the path using <code><a href="path2twilight.html">path2twilight()</a></code>. Sunrise and sunset are defined
by the solar depression angle <code>solar_dep</code>.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">pressurepath_create</span><span class="op">(</span></span>
<span>  <span class="va">tag</span>,</span>
<span>  path <span class="op">=</span> <span class="fu"><a href="tag2path.html">tag2path</a></span><span class="op">(</span><span class="va">tag</span><span class="op">)</span>,</span>
<span>  variable <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"altitude"</span>, <span class="st">"surface_pressure"</span><span class="op">)</span>,</span>
<span>  solar_dep <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  era5_dataset <span class="op">=</span> <span class="st">"both"</span>,</span>
<span>  preprocess <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  timeout <span class="op">=</span> <span class="fl">60</span> <span class="op">*</span> <span class="fl">10</span>,</span>
<span>  workers <span class="op">=</span> <span class="st">"auto"</span>,</span>
<span>  quiet <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  debug <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-tag">tag<a class="anchor" aria-label="anchor" href="#arg-tag"></a></dt>
<dd><p>a GeoPressureR <code>tag</code> object.</p></dd>


<dt id="arg-path">path<a class="anchor" aria-label="anchor" href="#arg-path"></a></dt>
<dd><p>a GeoPressureR <code>path</code> data.frame.</p></dd>


<dt id="arg-variable">variable<a class="anchor" aria-label="anchor" href="#arg-variable"></a></dt>
<dd><p>ERA5 variable/parameters available to download.
The most commonly used variables:<code>"altitude"</code>, <code>"surface_pressure"</code>, <code>"temperature_2m"</code>,
<code>"u_component_of_wind_10m"</code>, <code>"v_component_of_wind_10m"</code>, <code>"u_component_of_wind_100m"</code>,
<code>"v_component_of_wind_100m"</code>, <code>"total_cloud_cover"</code>, <code>"total_precipitation"</code>, <code>"land_sea_mask"</code>.
All variables can be listed with <code>GeoPressureR:::pressurepath_variable</code>.</p></dd>


<dt id="arg-solar-dep">solar_dep<a class="anchor" aria-label="anchor" href="#arg-solar-dep"></a></dt>
<dd><p>a numerical value representing the solar depression angle used to compute
sunrise and sunset. If <code>NULL</code>, does not compute sunrise sunset.</p></dd>


<dt id="arg-era-dataset">era5_dataset<a class="anchor" aria-label="anchor" href="#arg-era-dataset"></a></dt>
<dd><p>select the dataset to use: <code>"single-levels"</code> for <a href="https://doi.org/10.24381/cds.adbb2d47" class="external-link">ERA5 hourly data on single levels</a>, <code>"land"</code> for <a href="https://doi.org/10.24381/cds.e2161bac" class="external-link">ERA5-Land hourly data</a> or <code>"both"</code> to use land where available and sing-levels
otherwise (i.e. over water). LAND has greater precision but is not available on water. Using a
single one makes the query faster.</p></dd>


<dt id="arg-preprocess">preprocess<a class="anchor" aria-label="anchor" href="#arg-preprocess"></a></dt>
<dd><p>logical to pre-process pressure data with <code><a href="geopressure_map_preprocess.html">geopressure_map_preprocess()</a></code>.</p></dd>


<dt id="arg-timeout">timeout<a class="anchor" aria-label="anchor" href="#arg-timeout"></a></dt>
<dd><p>duration before the code is interrupted both for the request on
GeoPressureAPI and on GEE (in seconds, see <code><a href="https://httr2.r-lib.org/reference/req_timeout.html" class="external-link">httr2::req_timeout()</a></code>).</p></dd>


<dt id="arg-workers">workers<a class="anchor" aria-label="anchor" href="#arg-workers"></a></dt>
<dd><p>number of parallel requests on GEE. Integer between 1 and 99.</p></dd>


<dt id="arg-quiet">quiet<a class="anchor" aria-label="anchor" href="#arg-quiet"></a></dt>
<dd><p>logical to hide messages about the progress</p></dd>


<dt id="arg-debug">debug<a class="anchor" aria-label="anchor" href="#arg-debug"></a></dt>
<dd><p>logical to display additional information to debug a request</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A GeoPressureR <code>pressurepath</code> data.frame with columns:</p><ul><li><p><code>date</code> same as <code>pressure$date</code></p></li>
<li><p><code>stap_id</code> same as <code>pressure$stap_id</code></p></li>
<li><p><code>pressure_tag</code> same as <code>pressure$value</code></p></li>
<li><p><code>label</code> same as <code>pressure$label</code></p></li>
<li><p><code>j</code> same as <code>path$j</code></p></li>
<li><p><code>lat</code> same as <code>path$lat</code></p></li>
<li><p><code>lon</code> same as <code>path$lon</code></p></li>
<li><p><code>include</code> same as <code>path$include</code></p></li>
<li><p><code>known</code> same as <code>path$known</code></p></li>
<li><p><code>altitude</code> altitude of the bird along the path (see detail)</p></li>
<li><p><code>surface_pressure</code> pressure retrieved from ERA5.</p></li>
<li><p><code>surface_pressure_norm</code> pressure retrieved from ERA5 normalized to the average of
<code>pressure_tag</code> over the stationary period.</p></li>
<li><p><code>sunrise</code> datetime of the sunrise according to <code>solar_dep</code>.</p></li>
<li><p><code>sunset</code> datetime of the sunset according to <code>solar_dep</code>.</p></li>
<li><p><code>...</code> any other ERA5 variable requested by <code>variable</code></p></li>
</ul></div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><a href="https://raphaelnussbaumer.com/GeoPressureManual/pressure-map.html" class="external-link">GeoPressureManual | Pressure Map</a></p>
<p>Other pressurepath:
<code><a href="geopressure_timeseries.html">geopressure_timeseries</a>()</code>,
<code><a href="plot_pressurepath.html">plot_pressurepath</a>()</code></p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="fu">withr</span><span class="fu">::</span><span class="fu"><a href="https://withr.r-lib.org/reference/with_dir.html" class="external-link">with_dir</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, package <span class="op">=</span> <span class="st">"GeoPressureR"</span><span class="op">)</span>, <span class="op">{</span></span></span>
<span class="r-in"><span>  <span class="va">tag</span> <span class="op">&lt;-</span> <span class="fu"><a href="tag_create.html">tag_create</a></span><span class="op">(</span><span class="st">"18LX"</span>, quiet <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="tag_label.html">tag_label</a></span><span class="op">(</span>quiet <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">path</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  stap_id <span class="op">=</span> <span class="va">tag</span><span class="op">$</span><span class="va">stap</span><span class="op">$</span><span class="va">stap_id</span>,</span></span>
<span class="r-in"><span>  lat <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">48.5</span>, <span class="fl">32.5</span>, <span class="fl">30.5</span>, <span class="fl">49.5</span>, <span class="fl">41.6</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  lon <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">17.5</span>, <span class="fl">13.5</span>, <span class="fl">16.5</span>, <span class="fl">21.5</span>, <span class="fl">12.7</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">pressurepath</span> <span class="op">&lt;-</span> <span class="fu">pressurepath_create</span><span class="op">(</span><span class="va">tag</span>, path <span class="op">=</span> <span class="va">path</span>, quiet <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-err co"><span class="r-pr">#&gt;</span> <span class="error">Error in httr2::req_perform(req):</span> HTTP 400 Bad Request.</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/str.html" class="external-link">str</a></span><span class="op">(</span><span class="va">pressurepath</span><span class="op">)</span></span></span>
<span class="r-err co"><span class="r-pr">#&gt;</span> <span class="error">Error:</span> object 'pressurepath' not found</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="plot_pressurepath.html">plot_pressurepath</a></span><span class="op">(</span><span class="va">pressurepath</span><span class="op">)</span></span></span>
<span class="r-err co"><span class="r-pr">#&gt;</span> <span class="error">Error:</span> object 'pressurepath' not found</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">pressurepath</span> <span class="op">&lt;-</span> <span class="fu">pressurepath_create</span><span class="op">(</span></span></span>
<span class="r-in"><span>  <span class="va">tag</span>,</span></span>
<span class="r-in"><span>  <span class="va">path</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">3</span>, <span class="fl">4</span><span class="op">)</span>, <span class="op">]</span>,</span></span>
<span class="r-in"><span>  quiet <span class="op">=</span> <span class="cn">TRUE</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-err co"><span class="r-pr">#&gt;</span> <span class="error">Error in httr2::req_perform(req):</span> HTTP 400 Bad Request.</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="plot_pressurepath.html">plot_pressurepath</a></span><span class="op">(</span><span class="va">pressurepath</span><span class="op">)</span></span></span>
<span class="r-err co"><span class="r-pr">#&gt;</span> <span class="error">Error:</span> object 'pressurepath' not found</span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Raphaël Nussbaumer, Mathieu Gravey.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer></div>





  </body></html>

