<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en-GB"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Download flight data — tag_download_wind • GeoPressureR</title><!-- favicons --><link rel="icon" type="image/png" sizes="96x96" href="../favicon-96x96.png"><link rel="icon" type="”image/svg+xml”" href="../favicon.svg"><link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png"><link rel="icon" sizes="any" href="../favicon.ico"><link rel="manifest" href="../site.webmanifest"><!-- katex math --><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/katex.min.css" integrity="sha384-nB0miv6/jRmo5UMMR1wu3Gz6NLsoTkbqJghGIsx//Rlm+ZU03BU6SQNC66uf4l5+" crossorigin="anonymous"><script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/katex.min.js" integrity="sha384-7zkQWkzuo3B5mTepMUcHkMB5jZaolc2xDwL6VFqjFALcbeS9Ggm/Yr2r3Dy4lfFg" crossorigin="anonymous"></script><script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/contrib/auto-render.min.js" integrity="sha384-43gviWU0YVjaDtb/GhzOouOXtZMP/7XUzwPTstBeZFe/+rCMvRwr4yROQP43s0Xk" crossorigin="anonymous" onload="renderMathInElement(document.body);"></script><script src="../katex-auto.js"></script><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Download flight data — tag_download_wind"><meta name="description" content='This function downloads data associated to each flight from the ERA5 hourly pressure levels
with the Climate Data Store (CDS) and through the ecmwfr R package.
Any variable available from the ERA5 pressure level can be downloaded.
The flights are determined from the stationary periods classified tag$stap. It requests a
single file for each flight using the exact time (hourly basis) and pressure (altitude). To make
the download more efficient, wf_request_batch()
is used to download all files at the same time (up to 20 requests in parallel).
To be able to download data from the Climate Data Store (CDS), you will need to create an ECMWF
account on https://www.ecmwf.int/. Once created, you can
retrieve your API Token on https://cds.climate.copernicus.eu/profile and save them in your local keychain with:

  ecmwfr::wf_set_key("abcd1234-foo-bar-98765431-XXXXXXXXXX")

More information in the GeoPressureManual.'><meta property="og:description" content='This function downloads data associated to each flight from the ERA5 hourly pressure levels
with the Climate Data Store (CDS) and through the ecmwfr R package.
Any variable available from the ERA5 pressure level can be downloaded.
The flights are determined from the stationary periods classified tag$stap. It requests a
single file for each flight using the exact time (hourly basis) and pressure (altitude). To make
the download more efficient, wf_request_batch()
is used to download all files at the same time (up to 20 requests in parallel).
To be able to download data from the Climate Data Store (CDS), you will need to create an ECMWF
account on https://www.ecmwf.int/. Once created, you can
retrieve your API Token on https://cds.climate.copernicus.eu/profile and save them in your local keychain with:

  ecmwfr::wf_set_key("abcd1234-foo-bar-98765431-XXXXXXXXXX")

More information in the GeoPressureManual.'><meta property="og:image" content="https://raphaelnussbaumer.com/GeoPressureR/logo.png"><!-- Global site tag (gtag.js) - Google Analytics --><script async src="https://www.googletagmanager.com/gtag/js?id=G-M5FY4BPHTB"></script><script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-M5FY4BPHTB');
</script><!-- Google tag (gtag.js) --></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">GeoPressureR</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="Released version">3.4.4</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">News</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/Rafnuss/GeoPressureR/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Download flight data</h1>
      <small class="dont-index">Source: <a href="https://github.com/Rafnuss/GeoPressureR/blob/master/R/tag_download_wind.R" class="external-link"><code>R/tag_download_wind.R</code></a></small>
      <div class="d-none name"><code>tag_download_wind.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>This function downloads data associated to each flight from the <a href="https://cds.climate.copernicus.eu/cdsapp#!/dataset/reanalysis-era5-pressure-levels?tab=overview" class="external-link">ERA5 hourly pressure levels</a>
with the <a href="https://cds.climate.copernicus.eu/" class="external-link">Climate Data Store (CDS)</a> and through the <a href="https://bluegreen-labs.github.io/ecmwfr/index.html" class="external-link"><code>ecmwfr</code> R package</a>.</p>
<p><a href="https://bit.ly/3BrwLBM" class="external-link">Any variable available from the ERA5 pressure level</a> can be downloaded.</p>
<p>The flights are determined from the stationary periods classified <code>tag$stap</code>. It requests a
single file for each flight using the exact time (hourly basis) and pressure (altitude). To make
the download more efficient, <a href="https://bluegreen-labs.github.io/ecmwfr/articles/advanced_vignette.html#batch-parallel-requests" class="external-link"><code>wf_request_batch()</code></a>
is used to download all files at the same time (up to 20 requests in parallel).</p>
<p>To be able to download data from the Climate Data Store (CDS), you will need to create an ECMWF
account on <a href="https://www.ecmwf.int/" class="external-link">https://www.ecmwf.int/</a>. Once created, you can
retrieve your API Token on <a href="https://cds.climate.copernicus.eu/profile" class="external-link">https://cds.climate.copernicus.eu/profile</a> and save them in your local keychain with:
<code>
  ecmwfr::wf_set_key("abcd1234-foo-bar-98765431-XXXXXXXXXX")
</code></p>
<p>More information <a href="https://raphaelnussbaumer.com/GeoPressureManual/geopressuretemplate-wind.html" class="external-link">in the GeoPressureManual</a>.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">tag_download_wind</span><span class="op">(</span></span>
<span>  <span class="va">tag</span>,</span>
<span>  extent <span class="op">=</span> <span class="va">tag</span><span class="op">$</span><span class="va">param</span><span class="op">$</span><span class="va">tag_set_map</span><span class="op">$</span><span class="va">extent</span>,</span>
<span>  include_stap_id <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  variable <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"u_component_of_wind"</span>, <span class="st">"v_component_of_wind"</span><span class="op">)</span>,</span>
<span>  file <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">stap_id</span>, <span class="va">tag_id</span><span class="op">)</span></span>
<span>    <span class="fu">glue</span><span class="fu">::</span><span class="fu"><a href="https://glue.tidyverse.org/reference/glue.html" class="external-link">glue</a></span><span class="op">(</span><span class="st">"./data/wind/{tag_id}/{tag_id}_{stap_id}.nc"</span><span class="op">)</span>,</span>
<span>  overwrite <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  workers <span class="op">=</span> <span class="fl">19</span>,</span>
<span>  cds_token <span class="op">=</span> <span class="fu">lifecycle</span><span class="fu">::</span><span class="fu"><a href="https://lifecycle.r-lib.org/reference/deprecated.html" class="external-link">deprecated</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-tag">tag<a class="anchor" aria-label="anchor" href="#arg-tag"></a></dt>
<dd><p>a GeoPressureR <code>tag</code> object.</p></dd>


<dt id="arg-extent">extent<a class="anchor" aria-label="anchor" href="#arg-extent"></a></dt>
<dd><p>geographical extent of the map on which the likelihood will be computed.
Vector of length 4 <code>c(xmin, xmax, ymin, ymax)</code> or <code>c(W, E, S, N)</code>.</p></dd>


<dt id="arg-include-stap-id">include_stap_id<a class="anchor" aria-label="anchor" href="#arg-include-stap-id"></a></dt>
<dd><p>stationary period identifiers of the start of the flight to download.
Default is to download all flights.</p></dd>


<dt id="arg-variable">variable<a class="anchor" aria-label="anchor" href="#arg-variable"></a></dt>
<dd><p>list of variables to download from <a href="https://bit.ly/3BrwLBM" class="external-link">the ERA5 pressure level </a>: <code>"u_component_of_wind"</code>, <code>"v_component_of_wind"</code>,  <code>"temperature"</code>,
<code>"fraction_of_cloud_cover"</code>, <code>"relative_humidity"</code>, <code>"vertical_velocity"</code>,
<code>"specific_cloud_ice_water_content"</code>, <code>"specific_cloud_liquid_water_content"</code>,
<code>"specific_humidity"</code>, <code>"specific_rain_water_content"</code>, <code>"specific_snow_water_content"</code>,
<code>"divergence"</code>, <code>"geopotential"</code>, <code>"ozone_mass_mixing_ratio"</code>, <code>"potential_vorticity"</code>,
<code>'vorticity"</code>.</p></dd>


<dt id="arg-file">file<a class="anchor" aria-label="anchor" href="#arg-file"></a></dt>
<dd><p>absolute or relative path of the ERA5 wind data file to be downloaded. Function
taking as arguments (1) the stationary period identifier and (2) the tag_id.</p></dd>


<dt id="arg-overwrite">overwrite<a class="anchor" aria-label="anchor" href="#arg-overwrite"></a></dt>
<dd><p>logical. If <code>TRUE</code>, file is overwritten.</p></dd>


<dt id="arg-workers">workers<a class="anchor" aria-label="anchor" href="#arg-workers"></a></dt>
<dd><p>maximum number of simultaneous request that will be submitted
to the service. Most ECMWF services are limited to 20 concurrent requests
(default = 2).</p></dd>


<dt id="arg-cds-token">cds_token<a class="anchor" aria-label="anchor" href="#arg-cds-token"></a></dt>
<dd><p><a href="https://lifecycle.r-lib.org/articles/stages.html#deprecated" class="external-link"><img src="figures/lifecycle-deprecated.svg" alt="[Deprecated]"></a> Enter the API token with
<code><a href="https://rdrr.io/pkg/ecmwfr/man/wf_set_key.html" class="external-link">ecmwfr::wf_set_key()</a></code></p></dd>


<dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>Arguments passed on to <code><a href="https://rdrr.io/pkg/ecmwfr/man/wf_request.html" class="external-link">ecmwfr::wf_request_batch</a></code></p><dl><dt><code>user</code></dt>
<dd><p>user (default = "ecmwf") provided by the ECMWF data service,
used to retrieve the token set by <code><a href="https://rdrr.io/pkg/ecmwfr/man/wf_set_key.html" class="external-link">wf_set_key</a></code></p></dd>

    <dt><code>path</code></dt>
<dd><p>path were to store the downloaded data</p></dd>

    <dt><code>time_out</code></dt>
<dd><p>how long to wait on a download to start (default =
<code>3600</code> seconds).</p></dd>

    <dt><code>retry</code></dt>
<dd><p>polling frequency of submitted request for downloading (default =
<code>30</code> seconds).</p></dd>

    <dt><code>request_list</code></dt>
<dd><p>a list of requests that will be processed in parallel.</p></dd>

    <dt><code>total_timeout</code></dt>
<dd><p>overall timeout limit for all the requests in seconds.</p></dd>


</dl></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>The path of the downloaded (requested file) or the an R6 object with download/transfer
information</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><a href="https://bluegreen-labs.github.io/ecmwfr/reference/wf_request.html" class="external-link"><code>wf_request_batch()</code> </a>,
<a href="https://raphaelnussbaumer.com/GeoPressureManual/trajectory-with-wind.html" class="external-link">GeoPressureManual </a></p>
<p>Other movement:
<code><a href="bird_create.html">bird_create</a>()</code>,
<code><a href="graph_set_movement.html">graph_set_movement</a>()</code>,
<code><a href="graph_transition.html">graph_transition</a>()</code>,
<code><a href="plot_graph_movement.html">plot_graph_movement</a>()</code>,
<code><a href="speed2prob.html">speed2prob</a>()</code></p></div>
    </div>

  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Raphaël Nussbaumer, Mathieu Gravey.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer></div>





  </body></html>

